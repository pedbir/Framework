CREATE VIEW Norm.vn_Area AS
							WITH temp AS (SELECT *, _isLast = LEAD(0,1,1) OVER (PARTITION BY Area_bkey ORDER BY SysValidFromDateTime) FROM   Norm.n_Area)
							SELECT  t1.Area_key, t2.SysExecutionLog_key, t2.SysDatetimeInsertedUTC, t2.SysDatetimeUpdatedUTC, t2.SysDatetimeDeletedUTC, t2.SysDatetimeReprocessedUTC, t2.SysModifiedUTC, t2.SysIsInferred, t2.SysValidFromDateTime, t2.SysSrcGenerationDateTime, t2.Area_bkey, t2.AreaName, t2.Geography_bkey, t2.Project_bkey, t2.Employee_MetroNetworkManager_bkey, t2.Employee_RegionConstructionManager_bkey, t2.Employee_DeliveryStreamLeader_bkey, t2.Employee_ConstructionManager_bkey, t2.SugarEnum_ConstructionStatus_bkey, t2.SugarEnum_SalesStatus_bkey, t2.SugarEnum_SourcingStatus_bkey, t2.SugarEnum_IikStatus_bkey, t2.SugarEnum_AreaType_bkey, t2.SugarEnum_Contractor_bkey, t2.SugarEnum_SalesOrganisation_bkey, t2.SugarEnum_ConstructionOrganisation_bkey, t2.SugarEnum_SubsidyArea_bkey, t2.SugarEnum_ProjectDesign_bkey, t2.SugarEnum_CountyAdvisoryBoardStatus_bkey, t2.InitialSalesStart, t2.AfterMarketSalesStart, t2.StrategicNetworkPlanningComplete, t2.LeasedUplinkExpected, t2.LeasedUplinkDeployed, t2.TRVPermissionNeeded, t2.SumOfTRVNeeded, t2.SumOfTRVSubmitted, t2.SumOfTRVApproved, t2.ExpectedApprovalOfTRV, t2.AllTRVApplicationsSubmitted, t2.AllTRVApplicationsApproved, t2.CommentOnTRV, t2.MunicipalLandPermit, t2.BuildingPermitApproved, t2.AllBuildingPermitsSubmitted, t2.CommentOnBuildingPermit, t2.PlannedInstallationStart, t2.PlannedInstallationComplete, t2.PlannedConstructionStart, t2.FinalDocumentationComplete, t2.CustomerCommunicationCount, t1._isLast
							FROM temp t1 
							INNER JOIN temp t2 ON t2.Area_bkey = t1.Area_bkey AND t2._isLast = 1