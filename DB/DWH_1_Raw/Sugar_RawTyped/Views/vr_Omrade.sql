CREATE VIEW Sugar_RawTyped.vr_Omrade AS
							WITH temp AS (SELECT *, _isLast = LEAD(0,1,1) OVER (PARTITION BY Omrade_bkey ORDER BY SysValidFromDateTime) FROM   Sugar_RawTyped.r_Omrade)
							SELECT  t1.Omrade_key, t2.SysExecutionLog_key, t2.SysDatetimeInsertedUTC, t2.SysDatetimeUpdatedUTC, t2.SysDatetimeDeletedUTC, t2.SysModifiedUTC, t2.SysIsInferred, t2.SysValidFromDateTime, t2.SysSrcGenerationDateTime, t2.Omrade_bkey, t2.Name, t2.Deleted, t2.Byggnationsstatusc, t2.Forsaljningsstatusc, t2.Statusupphandlingc, t2.Iikbeslutc, t2.Omraderegionc, t2.Stadsnatddc, t2.Kommunddc, t2.Typavortc, t2.Forsaljningpaborjadc, t2.Efterkampanjpaborjadc, t2.Saljstopputesaljc, t2.Planeradbyggstartc, t2.Planeratklardatumc, t2.Planeradinstallationstartc, t2.Planeratavslutkundinstallc, t2.Dateoverlamnadtillbyggc, t2.Projektnummerifsc, t2.Entreprenorddc, t2.Ansvarigsaljorganisationc, t2.Ansvarigbyggorganisationc, t2.Useridc, t2.Userid2c, t2.Userid3c, t2.Bidragsomradec, t2.Natdesignklarc, t2.Planeratleveransnodlankc, t2.Nodlankdriftsattc, t2.Projekteringddc, t2.Kommunavtalklarac, t2.Trvbehovsc, t2.Planeratklardatumtrvc, t2.Antaltrvbehovsc, t2.Antaltrvklarac, t2.Tillstandtrvklarac, t2.Tillstandtrvklaratextc, t2.Allatillstandtrvinskickadec, t2.Antaltrvinskickadec, t2.Tillstandlansstyrelsenc, t2.Lansstyrelseninskickatc, t2.Bygglovklarc, t2.Bygglovklartextc, t2.Allabygglovinskickadec, t2.Slutdokumentationklarc, t2.Konkurrentc, t2.Iikgodkantdatumc, t2.Antalutfordaschaktmeterc, t2.Antalplaneradeschaktmeterc, t2.Antalfibreradefosarc, t2.Planeratantalfosarc, t2.Antalmarkavtalbehovsc, t2.Ipgeografiipomrade1ipgeografiida, t2.UsersIpOmrade1UsersIda, t1._isLast
							FROM temp t1 
							INNER JOIN temp t2 ON t2.Omrade_bkey = t1.Omrade_bkey AND t2._isLast = 1