CREATE VIEW Sugar_RawTyped.vr_Leveranspunkt AS
							WITH temp AS (SELECT *, _isLast = LEAD(0,1,1) OVER (PARTITION BY Leveranspunkt_bkey ORDER BY SysValidFromDateTime) FROM   Sugar_RawTyped.r_Leveranspunkt)
							SELECT  t1.Leveranspunkt_key, t2.SysExecutionLog_key, t2.SysDatetimeInsertedUTC, t2.SysDatetimeUpdatedUTC, t2.SysDatetimeDeletedUTC, t2.SysModifiedUTC, t2.SysIsInferred, t2.SysValidFromDateTime, t2.SysSrcGenerationDateTime, t2.Leveranspunkt_bkey, t2.Name, t2.Deleted, t2.Netadminaddressidc, t2.Relevansc, t2.Migreradc, t2.Tjanstetypc, t2.Installationsdatumnetadminc, t2.Latitudec, t2.Longitudec, t2.Adressmasteridc, t2.Kampanj6maninternetc, t2.Sexmangratiskampanjtillc, t2.Bostadsnatfinnsc, t2.Shippingaddressstreetc, t2.Shippingaddresspostalcodec, t2.Shippingaddressstreetnamec, t2.Shippingaddressstreetnoc, t2.Shippingaddressentrancec, t2.Shippingaddressapartnumberc, t2.Shippingaddressaltapartnoc, t2.Shippingaddresscityc, t2.Shippingaddresscountryc, t2.Fastighetsbeteckningc, t2.Aktivtjanstc, t2.Gruppanslutningc, t2.Ipleveransobjektipleveranspunkteripleveransobjektida, t1._isLast
							FROM temp t1 
							INNER JOIN temp t2 ON t2.Leveranspunkt_bkey = t1.Leveranspunkt_bkey AND t2._isLast = 1